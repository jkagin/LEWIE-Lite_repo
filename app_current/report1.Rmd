---
output: pdf_document
params:
  totalmult: NULL
  gdpmult: NULL
  labmult: NULL
  capmult: NULL
  poormult: NULL
  nonpoormult: NULL
---

\begin{center}
\section{LEWIE-lite Dashboard Report}
\end{center}

&nbsp;

\subsection{For \textbf{every dollar} of tourist spending (multipliers):}

&nbsp;

```{r echo=FALSE, comment=NA, fig.align="center", message = FALSE}
library(ggplot2)
library(emojifont)
library(fontawesome)

rows <- 3
cols <- 2
boxes <- 6
padding <- 1
h <- 8
w <- 16
icons<-c("fa-gears", "fa-money", "fa-user", "fa-line-chart", "fa-money", "fa-building")

df <- data.frame(
    x = rep(seq(0, (w+padding)*cols-1, w+padding), times=rows),
    y = rep(seq(0, (h+padding)*rows-1, h+padding), each=cols),
    h = rep(h, boxes),
    w = rep(w, boxes),
    value = c(params$totalmult(),params$poormult(),params$labmult(),params$gdpmult(),params$nonpoormult(),params$capmult()),
    info = c("Total Production Multiplier",
             "Accruing to Poor Households",
             "Accruing to Labor",
             "Total Income Multiplier",
             "Accruing to NonPoor Households",
             "Accruing to Capital"),
    icon = fontawesome(icons),
    font_family = c(rep("fontawesome-webfont", boxes)),
    color = factor(1:boxes)
)

ggplot(df, aes(x, y, height = h, width = w, label = info)) +
    ## Create the tiles using the `color` column
    geom_tile(aes(fill = color)) +
    ## Add the numeric values as text in `value` column
    geom_text(color = "white", fontface = "bold", size = 10,
              aes(label = value, x = x - w/2.2, y = y + h/4), hjust = 0) +
    ## Add the labels for each box stored in the `info` column
    geom_text(color = "white", fontface = "bold", size = 3,
              aes(label = info, x = x - w/2.2, y = y-h/4), hjust = 0) +
    coord_fixed() +
    scale_fill_brewer(type = "qual",palette = "Dark2") +
    ## Use `geom_text()` to add the icons by specifying the unicode symbol.
    geom_text(size = 20, aes(label = icon, family = font_family,
                             x = x + w/4, y = y + h/8), alpha = 0.25) +
    theme_void() +
    guides(fill = FALSE)
```